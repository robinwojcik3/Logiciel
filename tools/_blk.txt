                        return True
                    sys.path = [qgis_py_root, qgis_py_lib, qgis_site, qgis_app_py] + [p for p in old_syspath if _keep_path(p)]
                except Exception as e:
                    log_with_time(f"sys.path cleanup skip: {e}")
                with ProcessPoolExecutor(max_workers=workers, mp_context=ctx) as ex:
                    futures = [ex.submit(worker_run, (chunk, cfg)) for chunk in chunks if chunk]
                    for fut in as_completed(futures):
                        try:
                            ok, ko = fut.result()
                            ok_total += ok
                            ko_total += ko
                            self.after(0, ui_update_progress, ok + ko)
                            log_with_time(f"Lot termin√©: {ok} OK, {ko} KO")
                        except Exception as e:
                            log_with_time(f"Erreur worker: {e}")
                # Restaure le sys.path initial
                sys.path = old_syspath
